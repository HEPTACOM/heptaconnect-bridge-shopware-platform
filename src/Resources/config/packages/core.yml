services:
    _instanceof:
        Symfony\Component\Messenger\Handler\MessageSubscriberInterface:
            tags:
                - { name: messenger.message_handler }

    heptacom_heptaconnect.logger:
        class: Psr\Log\LoggerInterface
        factory:
            - '@Shopware\Core\Framework\Log\LoggerFactory'
            - createRotating
        arguments:
            - heptacom_heptaconnect

    Heptacom\HeptaConnect\Core\Component\Composer\PackageConfigurationLoader:
        arguments:
            - '%kernel.project_dir%/composer.json'

    Heptacom\HeptaConnect\Core\Configuration\ConfigurationService: ~

    Heptacom\HeptaConnect\Core\Emission\EmitContext:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Mapping\MappingService'
            - '@Heptacom\HeptaConnect\Core\Configuration\ConfigurationService'
            - '@Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry'

    Heptacom\HeptaConnect\Core\Emission\EmitService:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Emission\EmitContext'
            - '@heptacom_heptaconnect.logger'
            - '@messenger.bus.shopware'
            - '@Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry'

    Heptacom\HeptaConnect\Core\Exploration\ExploreContextFactory:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry'
            - '@Heptacom\HeptaConnect\Core\Configuration\ConfigurationService'

    Heptacom\HeptaConnect\Core\Exploration\ExploreService:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Exploration\ExploreContextFactory'
            - '@Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry'
            - '@Heptacom\HeptaConnect\Core\Mapping\Publisher'

    Heptacom\HeptaConnect\Core\Mapping\MappingService:
        arguments:
            - '@Heptacom\HeptaConnect\Bridge\ShopwarePlatform\Storage\Storage'

    Heptacom\HeptaConnect\Core\Mapping\Publisher:
        arguments:
            - '@Heptacom\HeptaConnect\Bridge\ShopwarePlatform\Storage\Storage'
            - '@messenger.bus.shopware'

    Heptacom\HeptaConnect\Core\Portal\ComposerPortalLoader:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Component\Composer\PackageConfigurationLoader'
            - '@Heptacom\HeptaConnect\Core\Portal\PortalFactory'

    Heptacom\HeptaConnect\Core\Portal\PortalFactory: ~

    Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Portal\PortalFactory'
            - '@Heptacom\HeptaConnect\Bridge\ShopwarePlatform\Storage\Storage'
            - '@Heptacom\HeptaConnect\Core\Portal\ComposerPortalLoader'

    Heptacom\HeptaConnect\Core\Portal\PortalRegistry:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Portal\ComposerPortalLoader'

    Heptacom\HeptaConnect\Core\Receive\ReceiveContext:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Mapping\MappingService'
            - '@Heptacom\HeptaConnect\Core\Configuration\ConfigurationService'
            - '@Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry'

    Heptacom\HeptaConnect\Core\Receive\ReceiveService:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Mapping\MappingService'
            - '@Heptacom\HeptaConnect\Core\Receive\ReceiveContext'
            - '@heptacom_heptaconnect.logger'
            - '@Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry'

    Heptacom\HeptaConnect\Core\Router\Router:
        arguments:
            - '@Heptacom\HeptaConnect\Core\Emission\EmitService'
            - '@Heptacom\HeptaConnect\Core\Receive\ReceiveService'
            - '@Heptacom\HeptaConnect\Core\Portal\PortalNodeRegistry'
            - '@Heptacom\HeptaConnect\Bridge\ShopwarePlatform\Storage\Storage'
            - '@Heptacom\HeptaConnect\Core\Mapping\MappingService'
